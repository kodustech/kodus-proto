{"version":3,"file":"deserializer.js","sourceRoot":"","sources":["../../../common/ast/deserializer.ts"],"names":[],"mappings":";;;AAAA,yCAAqE;AACrE,sDAIuC;AAEvC,MAAa,eAAe;IACxB,MAAM,CAAC,wBAAwB,CAC3B,UAAiC;QAEjC,MAAM,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAC1C,GAAG,IAAI;YACP,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,mBAAQ,CAAC,KAAK,EAAE,UAAU;SAClE,CAAC,CAAC,CAAC;QAEJ,MAAM,aAAa,GAAG,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;YAClE,GAAG,YAAY;YACf,IAAI,EACA,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,IAAI,CAAC;gBAC3C,2BAAgB,CAAC,KAAK,EAAE,UAAU;SACzC,CAAC,CAAC,CAAC;QAEJ,OAAO;YACH,KAAK;YACL,aAAa;SAChB,CAAC;IACN,CAAC;IAEO,MAAM,CAAU,WAAW,GAO/B;QACA,CAAC,aAAkB,CAAC,eAAe,CAAC,EAAE,mBAAQ,CAAC,KAAK;QACpD,CAAC,aAAkB,CAAC,kBAAkB,CAAC,EAAE,mBAAQ,CAAC,QAAQ;QAC1D,CAAC,aAAkB,CAAC,mBAAmB,CAAC,EAAE,mBAAQ,CAAC,SAAS;QAC5D,CAAC,aAAkB,CAAC,gBAAgB,CAAC,EAAE,mBAAQ,CAAC,MAAM;KACzD,CAAC;IAEM,MAAM,CAAU,mBAAmB,GAOvC;QACA,CAAC,qBAA0B,CAAC,uBAAuB,CAAC,EAChD,2BAAgB,CAAC,KAAK;QAC1B,CAAC,qBAA0B,CAAC,sCAAsC,CAAC,EAC/D,2BAAgB,CAAC,oBAAoB;QACzC,CAAC,qBAA0B,CAAC,4BAA4B,CAAC,EACrD,2BAAgB,CAAC,UAAU;QAC/B,CAAC,qBAA0B,CAAC,yBAAyB,CAAC,EAClD,2BAAgB,CAAC,OAAO;QAC5B,CAAC,qBAA0B,CAAC,4BAA4B,CAAC,EACrD,2BAAgB,CAAC,UAAU;QAC/B,CAAC,qBAA0B,CAAC,gCAAgC,CAAC,EACzD,2BAAgB,CAAC,cAAc;QACnC,CAAC,qBAA0B,CAAC,yBAAyB,CAAC,EAClD,2BAAgB,CAAC,OAAO;KAC/B,CAAC;;AA1DN,0CA2DC","sourcesContent":["import { EnrichGraph, NodeType, RelationshipType } from \"./enriched\";\nimport {\n    EnrichGraph as SerializedEnrichGraph,\n    NodeType as SerializedNodeType,\n    RelationshipType as SerializedRelationshipType,\n} from \"../../gen/NestJs/kodus/ast/v2\";\n\nexport class ASTDeserializer {\n    static deserializeEnrichedGraph(\n        serialized: SerializedEnrichGraph\n    ): EnrichGraph {\n        const nodes = serialized.nodes.map((node) => ({\n            ...node,\n            type: this.nodeTypeMap[node.type] ?? NodeType.CLASS, // Default\n        }));\n\n        const relationships = serialized.relationships.map((relationship) => ({\n            ...relationship,\n            type:\n                this.relationshipTypeMap[relationship.type] ??\n                RelationshipType.CALLS, // Default\n        }));\n\n        return {\n            nodes,\n            relationships,\n        };\n    }\n\n    private static readonly nodeTypeMap: Record<\n        Exclude<\n            SerializedNodeType,\n            | SerializedNodeType.UNRECOGNIZED\n            | SerializedNodeType.NODE_TYPE_UNSPECIFIED\n        >,\n        NodeType\n    > = {\n        [SerializedNodeType.NODE_TYPE_CLASS]: NodeType.CLASS,\n        [SerializedNodeType.NODE_TYPE_FUNCTION]: NodeType.FUNCTION,\n        [SerializedNodeType.NODE_TYPE_INTERFACE]: NodeType.INTERFACE,\n        [SerializedNodeType.NODE_TYPE_METHOD]: NodeType.METHOD,\n    };\n\n    private static readonly relationshipTypeMap: Record<\n        Exclude<\n            SerializedRelationshipType,\n            | SerializedRelationshipType.UNRECOGNIZED\n            | SerializedRelationshipType.RELATIONSHIP_TYPE_UNSPECIFIED\n        >,\n        RelationshipType\n    > = {\n        [SerializedRelationshipType.RELATIONSHIP_TYPE_CALLS]:\n            RelationshipType.CALLS,\n        [SerializedRelationshipType.RELATIONSHIP_TYPE_CALLS_IMPLEMENTATION]:\n            RelationshipType.CALLS_IMPLEMENTATION,\n        [SerializedRelationshipType.RELATIONSHIP_TYPE_HAS_METHOD]:\n            RelationshipType.HAS_METHOD,\n        [SerializedRelationshipType.RELATIONSHIP_TYPE_IMPORTS]:\n            RelationshipType.IMPORTS,\n        [SerializedRelationshipType.RELATIONSHIP_TYPE_IMPLEMENTS]:\n            RelationshipType.IMPLEMENTS,\n        [SerializedRelationshipType.RELATIONSHIP_TYPE_IMPLEMENTED_BY]:\n            RelationshipType.IMPLEMENTED_BY,\n        [SerializedRelationshipType.RELATIONSHIP_TYPE_EXTENDS]:\n            RelationshipType.EXTENDS,\n    };\n}\n"]}