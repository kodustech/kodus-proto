{"version":3,"file":"serializer.js","sourceRoot":"","sources":["../../../serialization/ast/serializer.ts"],"names":[],"mappings":";;;AAMA,MAAa,aAAa;IACtB,MAAM,CAAC,kBAAkB,CAAC,KAAgB;QACtC,MAAM,KAAK,GAAG,MAAM,CAAC,WAAW,CAC5B,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC;YACpD,GAAG;YACH;gBACI,GAAG,KAAK;gBACR,KAAK,EAAE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;aACnD;SACJ,CAAC,CACL,CAAC;QAEF,MAAM,SAAS,GAAG,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC;QAChE,MAAM,KAAK,GAAG,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;QAExD,OAAO;YACH,KAAK;YACL,SAAS;YACT,KAAK;SACR,CAAC;IACN,CAAC;IAED,MAAM,CAAC,8BAA8B,CACjC,IAA2B;QAE3B,MAAM,SAAS,GAAG;YACd,KAAK,EAAE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;YACpD,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG;SAC1B,CAAC;QAEF,MAAM,SAAS,GAAG;YACd,KAAK,EAAE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;YACpD,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG;SAC1B,CAAC;QAEF,OAAO;YACH,SAAS;YACT,SAAS;YACT,eAAe,EAAE,IAAI,CAAC,eAAe;SACxC,CAAC;IACN,CAAC;CACJ;AAzCD,sCAyCC","sourcesContent":["import {\n    CodeGraph,\n    GetGraphsResponseData,\n} from \"../../gen/NestJs/kodus/ast/v2\";\nimport { SerializedCodeGraph, SerializedGetGraphsResponseData } from \"./graph\";\n\nexport class ASTSerializer {\n    static serializeCodeGraph(graph: CodeGraph): SerializedCodeGraph {\n        const files = Object.fromEntries(\n            Array.from(graph.files.entries()).map(([key, value]) => [\n                key,\n                {\n                    ...value,\n                    nodes: Object.fromEntries(value.nodes.entries()),\n                },\n            ])\n        );\n\n        const functions = Object.fromEntries(graph.functions.entries());\n        const types = Object.fromEntries(graph.types.entries());\n\n        return {\n            files,\n            functions,\n            types,\n        };\n    }\n\n    static serializeGetGraphsResponseData(\n        data: GetGraphsResponseData\n    ): SerializedGetGraphsResponseData {\n        const baseGraph = {\n            graph: this.serializeCodeGraph(data.baseGraph.graph),\n            dir: data.baseGraph.dir,\n        };\n\n        const headGraph = {\n            graph: this.serializeCodeGraph(data.headGraph.graph),\n            dir: data.headGraph.dir,\n        };\n\n        return {\n            baseGraph,\n            headGraph,\n            enrichHeadGraph: data.enrichHeadGraph,\n        };\n    }\n}\n"]}