{"version":3,"file":"deserializer.js","sourceRoot":"","sources":["../../../serialization/ast/deserializer.ts"],"names":[],"mappings":";;;AAOA,MAAa,eAAe;IACxB,MAAM,CAAC,oBAAoB,CAAC,UAA+B;QACvD,MAAM,KAAK,GAAG,IAAI,GAAG,CACjB,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC;YACnD,GAAG;YACH;gBACI,GAAG,KAAK;gBACR,KAAK,EAAE,IAAI,GAAG,CACV,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC;oBAChD,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC;oBACpB,IAAI;iBACP,CAAC,CACL;aACJ;SACJ,CAAC,CACL,CAAC;QACF,MAAM,SAAS,GAAG,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;QAChE,MAAM,KAAK,GAAG,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;QAExD,OAAO;YACH,KAAK;YACL,SAAS;YACT,KAAK;SACR,CAAC;IACN,CAAC;IAED,MAAM,CAAC,gCAAgC,CACnC,UAA2C;QAE3C,MAAM,SAAS,GAAG;YACd,KAAK,EAAE,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,SAAS,CAAC,KAAK,CAAC;YAC5D,GAAG,EAAE,UAAU,CAAC,SAAS,CAAC,GAAG;SAChC,CAAC;QAEF,MAAM,SAAS,GAAG;YACd,KAAK,EAAE,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,SAAS,CAAC,KAAK,CAAC;YAC5D,GAAG,EAAE,UAAU,CAAC,SAAS,CAAC,GAAG;SAChC,CAAC;QAEF,OAAO;YACH,SAAS;YACT,SAAS;YACT,eAAe,EAAE,UAAU,CAAC,eAAe;SAC9C,CAAC;IACN,CAAC;CACJ;AA7CD,0CA6CC","sourcesContent":["import { SerializedCodeGraph, SerializedGetGraphsResponseData } from \"./graph\";\nimport {\n    AnalysisNode,\n    CodeGraph,\n    GetGraphsResponseData,\n} from \"../../gen/NestJs/kodus/ast/v2\";\n\nexport class ASTDeserializer {\n    static deserializeCodeGraph(serialized: SerializedCodeGraph): CodeGraph {\n        const files = new Map(\n            Object.entries(serialized.files).map(([key, value]) => [\n                key,\n                {\n                    ...value,\n                    nodes: new Map(\n                        Object.entries(value.nodes).map(([nodeId, node]) => [\n                            parseInt(nodeId, 10),\n                            node,\n                        ])\n                    ),\n                },\n            ])\n        );\n        const functions = new Map(Object.entries(serialized.functions));\n        const types = new Map(Object.entries(serialized.types));\n\n        return {\n            files,\n            functions,\n            types,\n        };\n    }\n\n    static deserializeGetGraphsResponseData(\n        serialized: SerializedGetGraphsResponseData\n    ): GetGraphsResponseData {\n        const baseGraph = {\n            graph: this.deserializeCodeGraph(serialized.baseGraph.graph),\n            dir: serialized.baseGraph.dir,\n        };\n\n        const headGraph = {\n            graph: this.deserializeCodeGraph(serialized.headGraph.graph),\n            dir: serialized.headGraph.dir,\n        };\n\n        return {\n            baseGraph,\n            headGraph,\n            enrichHeadGraph: serialized.enrichHeadGraph,\n        };\n    }\n}\n"]}